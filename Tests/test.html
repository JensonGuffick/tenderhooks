<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deployment Count Display</title>
</head>
<body>
    <div id="deployment-count"></div>

    <script>
        // Function to fetch the token from token.txt
        async function fetchToken() {
            try {
                const response = await fetch('token.txt'); // Adjust path if necessary
                if (response.ok) {
                    const token = await response.text();
                    return token.trim(); // Remove any extra whitespace
                } else {
                    console.error('Failed to fetch token:', response.statusText);
                    return null;
                }
            } catch (error) {
                console.error('Error fetching token:', error);
                return null;
            }
        }

        // Function to fetch the deployment count from GitHub
        async function getDeploymentCount(token) {
            const owner = 'Tenderhooks';  // Replace with your GitHub username or organization
            const repo = 'tenderhooks.github.io';  // Replace with your repository name

            const headers = {
                'Authorization': `token ${token}`,
                'Accept': 'application/vnd.github.v3+json'
            };

            try {
                const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/deployments`, { headers });
                if (response.ok) {
                    const deployments = await response.json();
                    const deploymentCount = deployments.length; // Get the count of deployments
                    return deploymentCount;
                } else {
                    console.error('Failed to fetch deployments:', response.status, response.statusText);
                    return null;
                }
            } catch (error) {
                console.error('Error fetching deployments:', error);
                return null;
            }
        }

        async function updateDeploymentCount() {
            const token = await fetchToken();
            if (token) {
                const deploymentCount = await getDeploymentCount(token);
                if (deploymentCount !== null) {
                    document.getElementById('deployment-count').textContent = `Deployment Count: ${deploymentCount}`;
                }
            }
        }

        updateDeploymentCount();
    </script>
</body>
</html>
