name: Auto Commit with ver.txt

on:
  push:
    branches:
      - main  # Replace with your target branch

jobs:
  update-commit-message:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Read version message
        id: get_ver
        run: |
          ver_msg=$(cat ver.txt)
          echo "VER_MESSAGE=$ver_msg" >> $GITHUB_ENV

      - name: Configure Git
        run: |
          git config --global user.email "jensonguffick@yahoo.com"
          git config --global user.name "JensonGuffick"

      - name: Commit and Push Changes
        env:
          TOKEN: ${{ secrets.PAT_TOKEN }}
        run: |
          git remote set-url origin https://x-access-token:${TOKEN}@github.com/JensonGuffick/tenderhooks.git
          git commit --amend -m "$VER_MESSAGE"
          git push --force
